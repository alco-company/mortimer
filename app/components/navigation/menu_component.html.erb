<nav id="<%= @destination %>_menu" class="<%= @nav_classes %>">

  <% unless @current.user.nil? %>

    <% if @current.account != @current.user.account %>
      <%= helpers.render_component "button_to", url: account_impersonate_path(@current.user.account), css: "text-indigo-700 hover:bg-gray-500 group flex items-center px-2 py-2 #{@text} font-medium rounded-md" do %>
        <svg class="mr-4 flex-shrink-0 h-6 w-6 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg>
        <%= @current.account.name %>
      <% end %>
    <% end %>

    <!-- Current: " text-gray-700", Default: "text-indigo-100 hover:bg-indigo-600" -->
    
    <a href="/" class=" text-gray-500 hover:bg-gray-300 group flex items-center px-2 py-2 text-sm leading-5 <%= @text %> font-medium rounded-md">
      <span class="material-symbols-outlined">panorama</span>
      <span class="pl-2 truncate"><%= t(".dashboard")%></span>
    </a>

    <div id="user_<%= @user_id %>_services" class="space-y-1">

      <div class="bg-gray-100">
        <div class="w-full divide-y-2 divide-gray-200 p-1">
          <dl class="mt-6 space-y-2 divide-y divide-gray-200">
            <% index=0; @current.account.service_groups.each do |group| %>
              <div class="pt-2">
                <dt class="text-sm text-gray-500">
                  <!-- Expand/collapse question button -->
                  <button 
                    type="button" 
                    data-action="click->navigation--sidebar-component#toggleGroup"                    
                    id="button_group_<%= index %>"
                    class="flex w-full items-start text-left" 
                    aria-controls="accordion-0" 
                    aria-expanded="false">
                    <%= helpers.service_group_icon group %>
                    <span class="ml-1 font-medium pt-2"> <%= t(".#{group}") %> </span>
                    <span class="w-full grid h-7 items-center justify-items-end">
                      <!--
                        Expand/collapse icon, toggle classes based on question open state.

                        Heroicon name: outline/chevron-down

                        Open: "-rotate-180", Closed: "rotate-0"
                      -->
                      <svg class="rotate-0 h-5 w-5 transform text-gray-200" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-widivh="1.5" stroke="currentColor" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                      </svg>
                    </span>
                  </button>
                </dt>
                <dd class="mt-2 hidden" id="accordion-<%= index %>" 
                  data-navigation--sidebar-component-target="accordion">
                  <p class="text-base text-gray-500">
                    <%= render( Navigation::ServiceComponent.with_collection @current.account.services.where(service_group: group), current: @current, css: @link_classes) if @current && @current.account %>
                  </p>
                </dd>
              </div>
            <% index=index+1;end %>
          </dl>
        </div>
      </div>
      

    </div>


    <%= helpers.render_component "navigation/super_user", current: @current if (@current && @current.user && @current.user.is_a_god?) %>
  <% end %>

</nav>






